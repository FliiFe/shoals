{"version":3,"sources":["webpack:///bundle.8e8dc69e14b0b4edfe8f.js","webpack:///./src/sketch/Utils.js","webpack:///./src/sketch/index.js","webpack:///./src/index.js","webpack:///./src/sketch/Fish.js","webpack:///./src/sketch/Population.js","webpack:///./src/sketch/Vector.js"],"names":["webpackJsonp","module","exports","__webpack_require__","Object","defineProperty","value","random","a","b","Math","mod","x","_interopRequireDefault","obj","__esModule","default","sketch","ctx","pop","stats","Stats","setup","createCanvas","windowWidth","windowHeight","showPanel","document","body","appendChild","dom","Population","populate","gui","dat","GUI","ncontroller","add","options","name","forces","addFolder","rayons","apparence","resetpop","killfish","onChange","reset","draw","begin","background","dark","run","end","mouseDragged","windowResized","resizeCanvas","_Population","_Population2","_stats","_stats2","_dat","newObj","key","prototype","hasOwnProperty","call","_p","_p2","_sketch","_sketch2","p5","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","protoProps","staticProps","_Vector","_Vector2","_Utils","Fish","y","opt","id","this","acc","Vector","v","pos","fish","inflacc","update","wrap","width","height","render","rulesf","rules","limit","vmax","scale","objectif","sub","normalise","attraction","fmax","_this","sepf","sepCount","cohf","cohCount","alif","aliCount","forEach","f","fpos","closerMod","dsq","distsq","cohr","alir","sepr","diff","div","sqrt","magSq","fsep","cohesionRes","seek","fcoh","alignmentRes","alf","fali","theta","heading","PI","floor","magnitude","fill","noStroke","push","translate","rotate","beginShape","vertex","bl","r","endShape","CLOSE","arc","showRadius","noFill","stroke","vangle","_Fish","_Fish2","setDefaults","n","addFish","atan2","pow","s","mag","max","msq","w","h","v1","v2","copy","v1a","v2a","dx","dy","abs","sign"],"mappings":"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","file":"bundle.8e8dc69e14b0b4edfe8f.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Génère un nombre aléatoirement dans [a, b] selon une loi uniforme\n *\n * @param {Number} a\n * @param {Number} b\n * @returns {Number} flottant aléatoire de [a, b]\n */\nvar random = exports.random = function random(a, b) {\n  return Math.random() * (b - a) + a;\n};\n/**\n * Renvoie l'unique valeur de b de [0, x[ telle que a = b (mod x)\n *\n * @param {Number} a\n * @param {Number} x\n * @returns {Number} b\n */\nvar mod = exports.mod = function mod(a, x) {\n  return a < 0 ? a % x + x : a % x;\n};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = sketch;\n\nvar _Population = __webpack_require__(5);\n\nvar _Population2 = _interopRequireDefault(_Population);\n\nvar _stats = __webpack_require__(8);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _dat = __webpack_require__(7);\n\nvar dat = _interopRequireWildcard(_dat);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction sketch(ctx) {\n    var pop = void 0;\n    var stats = new _stats2.default();\n    ctx.setup = function () {\n        ctx.createCanvas(ctx.windowWidth, ctx.windowHeight);\n\n        stats.showPanel(0);\n        document.body.appendChild(stats.dom);\n\n        pop = new _Population2.default(ctx);\n        pop.populate(100);\n\n        var gui = new dat.GUI();\n        var ncontroller = gui.add(pop.options, 'n', 1, 1000).name('Poissons');\n        var forces = gui.addFolder('Forces');\n        forces.add(pop.options, 'vmax', 0, 10).name('Vitesse max');\n        forces.add(pop.options, 'fmax', 0, 0.2).name('Max');\n        forces.add(pop.options, 'fsep', 0, 5).name('Séparation');\n        forces.add(pop.options, 'fali', 0, 5).name('Alignement');\n        forces.add(pop.options, 'fcoh', 0, 5).name('Cohésion');\n        var rayons = gui.addFolder('Rayons');\n        rayons.add(pop.options, 'sepr', 0, 100, 5).name('Séparation');\n        rayons.add(pop.options, 'alir', 0, 100, 5).name('Alignement');\n        rayons.add(pop.options, 'cohr', 0, 100, 5).name('Cohésion');\n        var apparence = gui.addFolder('Apparence');\n        apparence.add(pop.options, 'showRadius').name('Afficher les zones');\n        apparence.add(pop.options, 'r', 0.5, 4, 0.5).name('Largeur');\n        apparence.add(pop.options, 'bl', 0, 30, 1).name('Longueur');\n        apparence.add(pop.options, 'wrap').name('Wrap');\n        apparence.add(pop.options, 'dark').name('Mode sombre');\n\n        var resetpop = function resetpop() {\n            pop.killfish();\n            pop.populate();\n        };\n\n        ncontroller.onChange(resetpop);\n\n        gui.add({ reset: resetpop }, 'reset').name('Redémarrer');\n    };\n\n    ctx.draw = function () {\n        stats.begin();\n        ctx.background(pop.options.dark ? 0 : 255);\n        pop.run();\n        stats.end();\n    };\n\n    ctx.mouseDragged = function () {}\n    // Ajoute un poisson à la position de la souris\n    // pop.addFish(new Fish(ctx.mouseX, ctx.mouseY, ctx))\n\n\n    // Quand la fenêtre est redimentionnée\n    ;ctx.windowResized = function () {\n        return ctx.resizeCanvas(ctx.windowWidth, ctx.windowHeight);\n    };\n}\n\n/***/ }),\n/* 2 */,\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _p = __webpack_require__(2);\n\nvar _p2 = _interopRequireDefault(_p);\n\nvar _sketch = __webpack_require__(1);\n\nvar _sketch2 = _interopRequireDefault(_sketch);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nnew _p2.default(_sketch2.default);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Vector = __webpack_require__(6);\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\nvar _Utils = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Fish = function () {\n    function Fish(x, y, opt, id) {\n        _classCallCheck(this, Fish);\n\n        // Vecteur accélération\n        this.acc = new _Vector2.default(0, 0);\n        // Vecteur vitesse\n        this.v = new _Vector2.default((0, _Utils.random)(-1, 1), (0, _Utils.random)(-1, 1));\n        // this.v = new Vector(0, 1)\n        // Vecteur position\n        this.pos = new _Vector2.default(x, y);\n        // Contexte pour dessiner (p5.js)\n        this.ctx = opt.ctx;\n        this.opt = opt;\n        this.id = id;\n    }\n\n    _createClass(Fish, [{\n        key: 'run',\n        value: function run(fish) {\n            // Calcule la nouvelle accélération avec les forces exercées par les autres poissons\n            this.inflacc(fish);\n            // Met à jour la position avec la nouvelle accélération\n            this.update();\n            // Remet le poisson dans le cadre s'il a dépassé (tore)\n            if (this.opt.wrap) this.pos.mod(this.ctx.width, this.ctx.height);\n\n            // Dessine le poisson\n            this.render();\n        }\n    }, {\n        key: 'inflacc',\n        value: function inflacc(fish) {\n            // Calcule la force résultante des trois règles\n            var rulesf = this.rules(fish);\n            // Applique les forces (PFD)\n            this.acc.add(rulesf);\n        }\n    }, {\n        key: 'update',\n        value: function update() {\n            if (!this.opt.wrap) {\n                var bounceback = 0.05;\n                var bound = 0.2;\n                if (this.pos.x > this.ctx.width * (1 - bound)) {\n                    this.acc.x += -bounceback;\n                }\n                if (this.pos.y > this.ctx.height * (1 - bound)) this.acc.y += -bounceback;\n                if (this.pos.x < this.ctx.width * bound) this.acc.x += bounceback;\n                if (this.pos.y < this.ctx.height * bound) this.acc.y += bounceback;\n            }\n            this.v.add(this.acc);\n            // Limite la vitesse\n            this.v.limit(this.opt.vmax);\n            // Met à jour la position\n            this.pos.add(this.v);\n            // On remet l'accélération à 0\n            this.acc.scale(0);\n        }\n    }, {\n        key: 'seek',\n        value: function seek(target) {\n            var objectif = _Vector2.default.sub(target, this.pos); // Un vecteur vers la cible\n            objectif.normalise();\n            objectif.scale(this.opt.vmax);\n            // objectif - vitesse\n            var attraction = _Vector2.default.sub(objectif, this.v);\n            attraction.limit(this.opt.fmax);\n            return attraction;\n        }\n    }, {\n        key: 'rules',\n        value: function rules(fish) {\n            var _this = this;\n\n            var sepf = new _Vector2.default(0, 0);\n            var sepCount = 0;\n            var cohf = new _Vector2.default(0, 0);\n            var cohCount = 0;\n            var alif = new _Vector2.default(0, 0);\n            var aliCount = 0;\n            fish.forEach(function (f) {\n                var fpos = _this.opt.wrap ? _Vector2.default.closerMod(_this.pos, f.pos, _this.ctx.width, _this.ctx.height) : f.pos;\n                var dsq = _Vector2.default.distsq(_this.pos, fpos);\n                if (dsq > 0 && dsq < Math.pow(_this.opt.cohr, 2)) {\n                    cohf.add(fpos);\n                    cohCount++;\n                }\n                if (dsq > 0 && dsq < Math.pow(_this.opt.alir, 2)) {\n                    alif.add(f.v);\n                    aliCount++;\n                }\n                if (dsq > 0 && dsq < Math.pow(_this.opt.sepr, 2)) {\n                    // Une force pour s'éloigner du poissons\n                    var diff = _Vector2.default.sub(_this.pos, fpos);\n                    diff.normalise();\n                    diff.div(Math.sqrt(dsq));\n                    sepf.add(diff);\n                    sepCount++;\n                }\n            });\n            if (sepCount > 0) {\n                sepf.div(sepCount);\n            }\n            if (sepf.magSq() > 0) {\n                sepf.normalise();\n                sepf.scale(this.opt.vmax);\n                sepf.sub(this.v);\n                sepf.limit(this.opt.fmax);\n            }\n            sepf.scale(this.opt.fsep);\n            var cohesionRes = new _Vector2.default(0, 0);\n            if (cohCount > 0) {\n                cohf.div(cohCount);\n                cohesionRes.add(this.seek(cohf, this.opt.vmax, this.opt.fmax).scale(this.opt.fcoh));\n            }\n            var alignmentRes = new _Vector2.default(0, 0);\n            if (aliCount > 0) {\n                alif.div(aliCount);\n                alif.normalise();\n                alif.scale(this.opt.vmax);\n                var alf = _Vector2.default.sub(alif, this.v);\n                alf.limit(this.opt.fmax);\n                alf.scale(this.opt.fali);\n                alignmentRes.add(alf);\n            }\n            return _Vector2.default.add(cohesionRes, alignmentRes).add(sepf);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var theta = this.v.heading() - Math.PI / 2;\n            var value = Math.floor(255 * this.v.magnitude() / this.opt.vmax);\n            this.ctx.fill(this.opt.dark ? value : 255 - value);\n            this.ctx.noStroke();\n            this.ctx.push();\n            this.ctx.translate(this.pos.x, this.pos.y);\n            this.ctx.rotate(theta);\n            this.ctx.beginShape();\n            this.ctx.vertex(0, 1 - this.opt.bl);\n            this.ctx.vertex(-this.opt.r, 0);\n            this.ctx.vertex(this.opt.r, 0);\n            this.ctx.endShape(this.ctx.CLOSE);\n            this.ctx.rotate(Math.PI / 2);\n            this.ctx.arc(0, 0, 2 * this.opt.r, 2 * this.opt.r, -Math.PI / 2, Math.PI / 2);\n            if (this.opt.showRadius && this.id === 1) {\n                this.ctx.noFill();\n                this.ctx.stroke(this.opt.dark ? 255 : 0);\n                this.ctx.arc(0, 0, this.opt.cohr, this.opt.cohr, -this.opt.vangle, this.opt.vangle);\n                this.ctx.arc(0, 0, this.opt.alir, this.opt.alir, -this.opt.vangle, this.opt.vangle);\n                this.ctx.arc(0, 0, this.opt.sepr, this.opt.sepr, -this.opt.vangle, this.opt.vangle);\n            }\n            this.ctx.pop();\n        }\n    }]);\n\n    return Fish;\n}();\n\nexports.default = Fish;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Fish = __webpack_require__(4);\n\nvar _Fish2 = _interopRequireDefault(_Fish);\n\nvar _Utils = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Population = function () {\n    function Population(ctx) {\n        _classCallCheck(this, Population);\n\n        this.fish = [];\n        this.ctx = ctx;\n        this.setDefaults();\n    }\n\n    _createClass(Population, [{\n        key: 'setDefaults',\n        value: function setDefaults() {\n            this.options = {\n                vmax: 3,\n                fmax: 0.05,\n                r: 3,\n                bl: 15,\n                sepr: 25,\n                alir: 50,\n                cohr: 50,\n                fsep: 1.5,\n                fali: 1,\n                fcoh: 1,\n                wrap: false,\n                n: 100,\n                ctx: this.ctx,\n                dark: false,\n                showRadius: false,\n                vangle: 5 * Math.PI / 6\n            };\n        }\n    }, {\n        key: 'run',\n        value: function run() {\n            var _this = this;\n\n            this.fish.forEach(function (f) {\n                return f.run(_this.fish);\n            });\n        }\n        /**\n         * Ajoute un poisson\n         *\n         * @param {Fish} fish poisson à ajouter\n         */\n\n    }, {\n        key: 'addFish',\n        value: function addFish(fish) {\n            this.fish.push(fish);\n        }\n    }, {\n        key: 'populate',\n        value: function populate() {\n            for (var i = 1; i <= this.options.n; i++) {\n                var b = new _Fish2.default(this.options.ctx.width / 2 + (0, _Utils.random)(-50, 50), this.options.ctx.height / 2 + (0, _Utils.random)(-50, 50), this.options, i);\n                this.addFish(b);\n            }\n        }\n    }, {\n        key: 'killfish',\n        value: function killfish() {\n            this.fish = [];\n        }\n    }]);\n\n    return Population;\n}();\n\nexports.default = Population;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Utils = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Vector = function () {\n    function Vector(x, y) {\n        _classCallCheck(this, Vector);\n\n        this.x = x;\n        this.y = y;\n    }\n    /**\n     * Angle fait avec la droite réelle, Arg(x + iy)\n     *\n     * @returns {Number} Angle dans ]-pi, pi[\n     */\n\n\n    _createClass(Vector, [{\n        key: 'heading',\n        value: function heading() {\n            return Math.atan2(this.y, this.x);\n        }\n        /**\n         * Additionne deux vecteurs.\n         *\n         * @param {Vector} v\n         * @returns {Vector} this + v\n         */\n\n    }, {\n        key: 'add',\n        value: function add(v) {\n            this.x += v.x;\n            this.y += v.y;\n            return this;\n        }\n        /**\n         * Fait la différence de deux vecteurs.\n         *\n         * @param {Vector} v\n         * @returns {Vector} this - v\n         */\n\n    }, {\n        key: 'sub',\n        value: function sub(v) {\n            this.x -= v.x;\n            this.y -= v.y;\n            return this;\n        }\n        /**\n         * Additionne deux vecteurs sans les modifier\n         *\n         * @static\n         * @param {Vector} v1 a\n         * @param {Vector} v2 b\n         * @returns {Vector} a+b\n         */\n\n    }, {\n        key: 'magnitude',\n\n        /**\n         * Norme\n         *\n         * @returns {Number}\n         */\n        value: function magnitude() {\n            return Math.sqrt(this.magSq());\n        }\n        /**\n         * Norme au carré\n         *\n         * @returns {Number}\n         */\n\n    }, {\n        key: 'magSq',\n        value: function magSq() {\n            return Math.pow(this.x, 2) + Math.pow(this.y, 2);\n        }\n        /**\n         * Renvoie une copie du vecteur\n         *\n         * @returns {Vector}\n         */\n\n    }, {\n        key: 'copy',\n        value: function copy() {\n            return new Vector(this.x, this.y);\n        }\n        /**\n         * Multiplication par un scalaire\n         *\n         * @param {Number} s\n         * @returns {Vector} s * this\n         */\n\n    }, {\n        key: 'scale',\n        value: function scale(s) {\n            this.x *= s;\n            this.y *= s;\n            return this;\n        }\n        /**\n         * Renvoie le vecteur unitaire v/||v||\n         *\n         * @returns {Vector}\n         */\n\n    }, {\n        key: 'normalise',\n        value: function normalise() {\n            var mag = this.magnitude();\n            return this.div(mag);\n        }\n        /**\n         * Division par un scalaire\n         *\n         * @param {Number} s\n         * @returns {Vector}\n         */\n\n    }, {\n        key: 'div',\n        value: function div(s) {\n            return this.scale(1 / s);\n        }\n        /**\n         * Limite la norme du vecteur à max\n         *\n         * @param {Number} max\n         * @returns {Vector}\n         */\n\n    }, {\n        key: 'limit',\n        value: function limit(max) {\n            var msq = this.magSq();\n            if (msq > max * max) this.div(Math.sqrt(msq)).scale(max);\n            return this;\n        }\n        /**\n         * Modifie les composantes du vecteur pour qu'elles soient dans le rectangle w*h\n         *\n         * @param {Number} w\n         * @param {Number} h\n         * @returns {Vector}\n         */\n\n    }, {\n        key: 'mod',\n        value: function mod(w, h) {\n            this.x = (0, _Utils.mod)(this.x, w);\n            this.y = (0, _Utils.mod)(this.y, h);\n            return this;\n        }\n        /**\n         * Renvoie le représentant de la classe de v2 le plus proche de v1\n         * sur un tore de largeur w et de hauteur h, munit de la relation d'équivalence\n         * (x, y) R (x', y') <=> x = x' (mod w) et y = y' (mod h).\n         * \n         *\n         * @static\n         * @param {Vector} v1\n         * @param {Vector} v2\n         * @param {Number} w largeur\n         * @param {Number} h hauteur\n         * @returns {Vecteur} v2' dans la classe de v2 qui minimise ||v1-v2||\n         */\n\n    }], [{\n        key: 'add',\n        value: function add(v1, v2) {\n            return v1.copy().add(v2);\n        }\n        /**\n         * Soustrait deux vecteurs sans les modifier\n         *\n         * @static\n         * @param {Vector} v1 a\n         * @param {Vector} v2 b\n         * @returns {Vector} a - b\n         */\n\n    }, {\n        key: 'sub',\n        value: function sub(v1, v2) {\n            return v1.copy().sub(v2);\n        }\n        /**\n         * Distance au carré entre v1 et v2\n         *\n         * @static\n         * @param {Vector} v1 a\n         * @param {Vector} v2 b\n         * @returns {Vector} || a - b ||^2\n         */\n\n    }, {\n        key: 'distsq',\n        value: function distsq(v1, v2) {\n            return v1.copy().sub(v2).magSq();\n        }\n        /**\n         * Calcule la distance entre v1 et v2\n         *\n         * @static\n         * @param {Vector} v1 a\n         * @param {Vector} v2 b\n         * @returns {Number} ||a-b||\n         */\n\n    }, {\n        key: 'dist',\n        value: function dist(v1, v2) {\n            return v1.copy().sub(v2).magnitude();\n        }\n    }, {\n        key: 'closerMod',\n        value: function closerMod(v1, v2, w, h) {\n            var v1a = v1.copy().mod(w, h);\n            var v2a = v2.copy().mod(w, h);\n            var dx = v1a.x - v2a.x;\n            var dy = v1a.y - v2a.y;\n            if (2 * Math.abs(dx) > w) v2a.x += w * Math.sign(dx);\n            if (2 * Math.abs(dy) > h) v2a.y += h * Math.sign(dy);\n            return v2a;\n        }\n    }]);\n\n    return Vector;\n}();\n\nexports.default = Vector;\n\n/***/ })\n],[3]);\n\n\n// WEBPACK FOOTER //\n// bundle.8e8dc69e14b0b4edfe8f.js","/**\n * Génère un nombre aléatoirement dans [a, b] selon une loi uniforme\n *\n * @param {Number} a\n * @param {Number} b\n * @returns {Number} flottant aléatoire de [a, b]\n */\nexport const random = (a, b) => Math.random() * (b - a) + a\n/**\n * Renvoie l'unique valeur de b de [0, x[ telle que a = b (mod x)\n *\n * @param {Number} a\n * @param {Number} x\n * @returns {Number} b\n */\nexport const mod = (a, x) => a < 0 ? a % x + x : a % x\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketch/Utils.js","import Population from './Population'\nimport Stats from 'stats.js'\nimport * as dat from 'dat.gui'\n\nexport default function sketch(ctx) {\n    let pop\n    let stats = new Stats()\n    ctx.setup = () => {\n        ctx.createCanvas(ctx.windowWidth, ctx.windowHeight)\n\n        stats.showPanel(0)\n        document.body.appendChild( stats.dom );\n\n        pop = new Population(ctx)\n        pop.populate(100)\n\n        let gui = new dat.GUI()\n        let ncontroller = gui.add(pop.options, 'n', 1, 1000).name('Poissons')\n        let forces = gui.addFolder('Forces')\n        forces.add(pop.options, 'vmax', 0, 10).name('Vitesse max')\n        forces.add(pop.options, 'fmax', 0, 0.2).name('Max')\n        forces.add(pop.options, 'fsep', 0, 5).name('Séparation')\n        forces.add(pop.options, 'fali', 0, 5).name('Alignement')\n        forces.add(pop.options, 'fcoh', 0, 5).name('Cohésion')\n        let rayons = gui.addFolder('Rayons')\n        rayons.add(pop.options, 'sepr', 0, 100, 5).name('Séparation')\n        rayons.add(pop.options, 'alir', 0, 100, 5).name('Alignement')\n        rayons.add(pop.options, 'cohr', 0, 100, 5).name('Cohésion')\n        let apparence = gui.addFolder('Apparence')\n        apparence.add(pop.options, 'showRadius').name('Afficher les zones')\n        apparence.add(pop.options, 'r', 0.5, 4, 0.5).name('Largeur')\n        apparence.add(pop.options, 'bl', 0, 30, 1).name('Longueur')\n        apparence.add(pop.options, 'wrap').name('Wrap')\n        apparence.add(pop.options, 'dark').name('Mode sombre')\n\n        const resetpop = () => {\n            pop.killfish()\n            pop.populate()\n        }\n\n        ncontroller.onChange(resetpop)\n\n        gui.add({reset: resetpop}, 'reset').name('Redémarrer')\n    }\n\n    ctx.draw = () => {\n        stats.begin()\n        ctx.background(pop.options.dark ? 0 : 255)\n        pop.run()\n        stats.end()\n    }\n\n    ctx.mouseDragged = () => {\n        // Ajoute un poisson à la position de la souris\n        // pop.addFish(new Fish(ctx.mouseX, ctx.mouseY, ctx))\n    }\n\n    // Quand la fenêtre est redimentionnée\n    ctx.windowResized = () => ctx.resizeCanvas(ctx.windowWidth, ctx.windowHeight)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketch/index.js","import p5 from 'p5'\nimport sketch from './sketch'\n\nnew p5(sketch)\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Vector from './Vector'\nimport { random } from './Utils'\n\nexport default class Fish {\n    constructor(x, y, opt, id) {\n        // Vecteur accélération\n        this.acc = new Vector(0, 0)\n        // Vecteur vitesse\n        this.v = new Vector(random(-1, 1), random(-1, 1))\n        // this.v = new Vector(0, 1)\n        // Vecteur position\n        this.pos = new Vector(x, y)\n        // Contexte pour dessiner (p5.js)\n        this.ctx = opt.ctx\n        this.opt = opt\n        this.id = id\n    }\n    run(fish) {\n        // Calcule la nouvelle accélération avec les forces exercées par les autres poissons\n        this.inflacc(fish)\n        // Met à jour la position avec la nouvelle accélération\n        this.update()\n        // Remet le poisson dans le cadre s'il a dépassé (tore)\n        if(this.opt.wrap) this.pos.mod(this.ctx.width, this.ctx.height)\n\n        // Dessine le poisson\n        this.render()\n    }\n    inflacc(fish) {\n        // Calcule la force résultante des trois règles\n        let rulesf = this.rules(fish)\n        // Applique les forces (PFD)\n        this.acc.add(rulesf)\n    }\n    update() {\n        if(!this.opt.wrap) {\n            let bounceback = 0.05\n            let bound = 0.2\n            if(this.pos.x > this.ctx.width * (1 - bound)) {\n                this.acc.x += -bounceback\n            }\n            if(this.pos.y > this.ctx.height * (1 - bound)) this.acc.y += -bounceback\n            if(this.pos.x < this.ctx.width * bound) this.acc.x += bounceback\n            if(this.pos.y < this.ctx.height * bound) this.acc.y += bounceback\n        }\n        this.v.add(this.acc)\n        // Limite la vitesse\n        this.v.limit(this.opt.vmax)\n        // Met à jour la position\n        this.pos.add(this.v)\n        // On remet l'accélération à 0\n        this.acc.scale(0)\n    }\n    seek(target) {\n        let objectif = Vector.sub(target, this.pos)  // Un vecteur vers la cible\n        objectif.normalise()\n        objectif.scale(this.opt.vmax)\n        // objectif - vitesse\n        let attraction = Vector.sub(objectif, this.v)\n        attraction.limit(this.opt.fmax)\n        return attraction\n    }\n    rules(fish) {\n        let sepf = new Vector(0, 0)\n        let sepCount = 0\n        let cohf = new Vector(0, 0)\n        let cohCount = 0\n        let alif = new Vector(0, 0)\n        let aliCount = 0\n        fish.forEach(f => {\n            let fpos = this.opt.wrap\n                ? Vector.closerMod(this.pos, f.pos, this.ctx.width, this.ctx.height)\n                : f.pos\n            let dsq = Vector.distsq(this.pos, fpos)\n            if ((dsq > 0) && (dsq < this.opt.cohr ** 2)) {\n                cohf.add(fpos)\n                cohCount++\n            }\n            if ((dsq > 0) && (dsq < this.opt.alir ** 2)) {\n                alif.add(f.v)\n                aliCount++\n            }\n            if ((dsq > 0) && (dsq < this.opt.sepr ** 2)) {\n                // Une force pour s'éloigner du poissons\n                let diff = Vector.sub(this.pos, fpos)\n                diff.normalise()\n                diff.div(Math.sqrt(dsq))\n                sepf.add(diff)\n                sepCount++\n            }\n        })\n        if (sepCount > 0) {\n            sepf.div(sepCount)\n        }\n        if (sepf.magSq() > 0) {\n            sepf.normalise()\n            sepf.scale(this.opt.vmax)\n            sepf.sub(this.v)\n            sepf.limit(this.opt.fmax)\n        }\n        sepf.scale(this.opt.fsep)\n        let cohesionRes = new Vector(0, 0)\n        if (cohCount > 0) {\n            cohf.div(cohCount)\n            cohesionRes.add(this.seek(cohf, this.opt.vmax, this.opt.fmax).scale(this.opt.fcoh))\n        }\n        let alignmentRes = new Vector(0, 0)\n        if (aliCount > 0) {\n            alif.div(aliCount)\n            alif.normalise()\n            alif.scale(this.opt.vmax)\n            let alf = Vector.sub(alif, this.v)\n            alf.limit(this.opt.fmax)\n            alf.scale(this.opt.fali)\n            alignmentRes.add(alf)\n        }\n        return Vector.add(cohesionRes, alignmentRes).add(sepf)\n    }\n    render() {\n        let theta = this.v.heading() - Math.PI / 2\n        let value = Math.floor(255 * this.v.magnitude() / this.opt.vmax)\n        this.ctx.fill(this.opt.dark ? value : 255 - value)\n        this.ctx.noStroke()\n        this.ctx.push()\n        this.ctx.translate(this.pos.x, this.pos.y)\n        this.ctx.rotate(theta)\n        this.ctx.beginShape()\n        this.ctx.vertex(0, 1 - this.opt.bl)\n        this.ctx.vertex(-this.opt.r, 0)\n        this.ctx.vertex(this.opt.r, 0)\n        this.ctx.endShape(this.ctx.CLOSE)\n        this.ctx.rotate(Math.PI / 2)\n        this.ctx.arc(0, 0, 2 * this.opt.r, 2 * this.opt.r, -Math.PI / 2, Math.PI / 2)\n        if(this.opt.showRadius && this.id === 1) {\n            this.ctx.noFill()\n            this.ctx.stroke(this.opt.dark ? 255 : 0)\n            this.ctx.arc(0, 0, this.opt.cohr, this.opt.cohr, -this.opt.vangle, this.opt.vangle)\n            this.ctx.arc(0, 0, this.opt.alir, this.opt.alir, -this.opt.vangle, this.opt.vangle)\n            this.ctx.arc(0, 0, this.opt.sepr, this.opt.sepr, -this.opt.vangle, this.opt.vangle)\n        }\n        this.ctx.pop()\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketch/Fish.js","import Fish from './Fish'\nimport { random } from './Utils'\n\nexport default class Population {\n    constructor(ctx) {\n        this.fish = []\n        this.ctx = ctx\n        this.setDefaults()\n    }\n    setDefaults() {\n        this.options = {\n            vmax: 3,\n            fmax: 0.05,\n            r: 3,\n            bl: 15,\n            sepr: 25,\n            alir: 50,\n            cohr: 50,\n            fsep: 1.5,\n            fali: 1,\n            fcoh: 1,\n            wrap: false,\n            n: 100,\n            ctx: this.ctx,\n            dark: false,\n            showRadius: false,\n            vangle: 5 * Math.PI / 6\n        }\n    }\n    run() {\n        this.fish.forEach(f => f.run(this.fish))\n    }\n    /**\n     * Ajoute un poisson\n     *\n     * @param {Fish} fish poisson à ajouter\n     */\n    addFish(fish) {\n        this.fish.push(fish)\n    }\n    populate() {\n        for (let i = 1; i <= this.options.n; i++) {\n            let b = new Fish(\n                this.options.ctx.width / 2 + random(-50, 50),\n                this.options.ctx.height / 2 + random(-50, 50),\n                this.options, i)\n            this.addFish(b)\n        }\n    }\n    killfish() {\n        this.fish = []\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketch/Population.js","import {mod} from './Utils'\nexport default class Vector {\n    constructor(x, y) {\n        this.x = x\n        this.y = y\n    }\n    /**\n     * Angle fait avec la droite réelle, Arg(x + iy)\n     *\n     * @returns {Number} Angle dans ]-pi, pi[\n     */\n    heading() {\n        return Math.atan2(this.y, this.x)\n    }\n    /**\n     * Additionne deux vecteurs.\n     *\n     * @param {Vector} v\n     * @returns {Vector} this + v\n     */\n    add(v) {\n        this.x += v.x\n        this.y += v.y\n        return this\n    }\n    /**\n     * Fait la différence de deux vecteurs.\n     *\n     * @param {Vector} v\n     * @returns {Vector} this - v\n     */\n    sub(v) {\n        this.x -= v.x\n        this.y -= v.y\n        return this\n    }\n    /**\n     * Additionne deux vecteurs sans les modifier\n     *\n     * @static\n     * @param {Vector} v1 a\n     * @param {Vector} v2 b\n     * @returns {Vector} a+b\n     */\n    static add(v1, v2) {\n        return v1.copy().add(v2)\n    }\n    /**\n     * Soustrait deux vecteurs sans les modifier\n     *\n     * @static\n     * @param {Vector} v1 a\n     * @param {Vector} v2 b\n     * @returns {Vector} a - b\n     */\n    static sub(v1, v2) {\n        return v1.copy().sub(v2)\n    }\n    /**\n     * Distance au carré entre v1 et v2\n     *\n     * @static\n     * @param {Vector} v1 a\n     * @param {Vector} v2 b\n     * @returns {Vector} || a - b ||^2\n     */\n    static distsq(v1, v2) {\n        return v1.copy().sub(v2).magSq()\n    }\n    /**\n     * Calcule la distance entre v1 et v2\n     *\n     * @static\n     * @param {Vector} v1 a\n     * @param {Vector} v2 b\n     * @returns {Number} ||a-b||\n     */\n    static dist(v1, v2) {\n        return v1.copy().sub(v2).magnitude()\n    }\n    /**\n     * Norme\n     *\n     * @returns {Number}\n     */\n    magnitude() {\n        return Math.sqrt(this.magSq())\n    }\n    /**\n     * Norme au carré\n     *\n     * @returns {Number}\n     */\n    magSq() {\n        return this.x ** 2 + this.y ** 2\n    }\n    /**\n     * Renvoie une copie du vecteur\n     *\n     * @returns {Vector}\n     */\n    copy() {\n        return new Vector(this.x, this.y)\n    }\n    /**\n     * Multiplication par un scalaire\n     *\n     * @param {Number} s\n     * @returns {Vector} s * this\n     */\n    scale(s) {\n        this.x *= s\n        this.y *= s\n        return this\n    }\n    /**\n     * Renvoie le vecteur unitaire v/||v||\n     *\n     * @returns {Vector}\n     */\n    normalise() {\n        let mag = this.magnitude()\n        return this.div(mag)\n    }\n    /**\n     * Division par un scalaire\n     *\n     * @param {Number} s\n     * @returns {Vector}\n     */\n    div(s) {\n        return this.scale(1 / s)\n    }\n    /**\n     * Limite la norme du vecteur à max\n     *\n     * @param {Number} max\n     * @returns {Vector}\n     */\n    limit(max) {\n        let msq = this.magSq()\n        if (msq > max * max) this.div(Math.sqrt(msq)).scale(max)\n        return this\n    }\n    /**\n     * Modifie les composantes du vecteur pour qu'elles soient dans le rectangle w*h\n     *\n     * @param {Number} w\n     * @param {Number} h\n     * @returns {Vector}\n     */\n    mod(w, h) {\n        this.x = mod(this.x, w)\n        this.y = mod(this.y, h)\n        return this\n    }\n    /**\n     * Renvoie le représentant de la classe de v2 le plus proche de v1\n     * sur un tore de largeur w et de hauteur h, munit de la relation d'équivalence\n     * (x, y) R (x', y') <=> x = x' (mod w) et y = y' (mod h).\n     * \n     *\n     * @static\n     * @param {Vector} v1\n     * @param {Vector} v2\n     * @param {Number} w largeur\n     * @param {Number} h hauteur\n     * @returns {Vecteur} v2' dans la classe de v2 qui minimise ||v1-v2||\n     */\n    static closerMod(v1, v2, w, h) {\n        let v1a = v1.copy().mod(w, h)\n        let v2a = v2.copy().mod(w, h)\n        let dx = v1a.x - v2a.x\n        let dy = v1a.y - v2a.y\n        if(2 * Math.abs(dx) > w) v2a.x += w * Math.sign(dx)\n        if(2 * Math.abs(dy) > h) v2a.y += h * Math.sign(dy)\n        return v2a\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketch/Vector.js"],"sourceRoot":""}